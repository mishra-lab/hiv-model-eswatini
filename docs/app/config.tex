% assume style config elsewhere
%---------------------------------------------------------------------------------------------------
% spacing & font tweaks
\RequirePackage{mathtools,underscore}
\RequirePackage[marginal,bottom,stable]{footmisc}
\RequirePackage[T1]{fontenc}
\widowpenalty9999
\clubpenalty9999
\frenchspacing
\renewcommand{\topfraction}{.85}
\renewcommand{\bottomfraction}{.7}
\renewcommand{\textfraction}{.15}
\renewcommand{\floatpagefraction}{.67}
%---------------------------------------------------------------------------------------------------
% toc
\RequirePackage{titletoc}
\newcommand{\apptoc}{
  \startcontents[app]
  \printcontents[app]{}{0}{\setstretch{.8}}
  \clearpage}
\makeatletter % HACK
\renewcommand*\l@subsection{\@dottedtocline{2}{1em}{2.8em}}
\renewcommand*\l@subsubsection{\@dottedtocline{3}{3.8em}{3.5em}}
\makeatother
%---------------------------------------------------------------------------------------------------
% figures
\RequirePackage{tikz,subcaption,graphicx}
\newcommand{\subcapoverlap}{\captionsetup[subfigure]{skip=-\baselineskip,margin=0pt}}
\newcommand{\figroot}{../../out/fig}
\newcommand{\uid}{2024-03-12/h1000i100b100}
\graphicspath{
  {\app/fig/}
  {\figroot/\uid/}
  {\figroot/\uid/base/}
  {\figroot/\uid/foi/}
  {\figroot/\uid/art/}
  {\figroot/wp/}
  {\figroot/toy/}
  {\figroot/tikz/}}
\def\fitscale{.475}
\def\mfx{}
%---------------------------------------------------------------------------------------------------
% tables
\RequirePackage{booktabs,multicol,multirow,array,lscape,longtable}
\newcolumntype{R}{r<{\null\hskip-\arraycolsep\null~}}
%---------------------------------------------------------------------------------------------------
% floatfoot
\newcommand{\floatfoot}[2][1]{\nopagebreak\vskip\abovecaptionskip\par
  \parbox{#1\linewidth}{\footnotesize#2}}
\newcommand{\ffpbar}[1][calibration target]{points and error bars: mean and 95\%~CI for each #1}
\newcommand{\ffbox}[1][model fits]{whiskers, boxes, and midlines: 95\%~CI, 50\%~CI, median of #1}
\newcommand{\ffribbon}[1][model fits]{ribbon and curve: range and median of #1}
\newcommand{\ffast}[1]{\ast denote significance of #1, where:
  $p < 0.1$: \ast, $p < 0.01$: \ast{}\ast, etc.}
\newcommand{\fffit}{1000 model fits (posterior parameter sets)}
\newcommand{\ffpost}{lines and circles: normalized density and means for each parameter}
\newcommand{\ffpar}{Table~\ref{tab:par.cal} gives parameter definitions}
\newcommand{\ffwiw}{median numbers of infections across all model fits shown}
\newcommand{\ffpops}{Low: lowest activity; Med: medium activity;
  LR/HR: lower/higher risk; FSW: female sex workers; Clients: of FSW}
\newcommand{\ffpopz}{FSW: female sex workers; Clients: of FSW;
  All Others: all women and men not involved in sex work}
\newcommand{\ffart}{Base case: \cashi by 2020;
  counterfactual scenarios: \casmd overall by 2020,
  with reduced cascade (\caslo: left behind) among FSW, clients of FSW, both, or neither}
\newcommand{\ffcas}{PLHIV: people living with HIV; VLS: viral load suppressed}
%---------------------------------------------------------------------------------------------------
% small macros
\RequirePackage{pifont,xspace}
\let\txn\textnormal
\let\txc\textsc
\newcommand{\ie}{\emph{i.e.,}\xspace}
\newcommand{\eg}{\emph{e.g.,}\xspace}
\newcommand{\vs}{\emph{vs}\xspace}
\newcommand{\p}{\bar{p}}
\newcommand{\yes}{{\ding{51}}}
\newcommand{\no}{{\ding{55}}}
\renewcommand{\ast}{\raisebox{-.5ex}{*}\xspace}
\newcommand{\ttilde}{\textasciitilde}
\newcommand{\tsub}[1]{\textsubscript{#1}}
\newcommand{\tsup}[1]{\textsuperscript{#1}}
\newcommand{\sref}[1]{\S\,\ref{#1}}
\newcommand{\sfref}[1]{(\subref{#1})}
\renewcommand{\eqref}[1]{Eq.~(\ref{#1})}
\newcommand{\eqrefs}[2]{Eqs. (\ref{#1})~and~(\ref{#2})}
\newcommand{\eqrefr}[2]{Eqs.~(\ref{#1})--(\ref{#2})}
\newcommand{\tn}[1]{\textsuperscript{\rlap{\,#1}}}
\newcommand{\tnt}[2][*]{\textsuperscript{#1\,}{#2}}
\newcommand{\cdf}[2]{\ifempty{#2}{CD4\,$>$\,#1}{\ifempty{#1}{}{#1\,$<$\,}CD4\,$<$\,#2}}
\newcommand{\opname}[1]{\textnormal{#1}\,}
\newcommand{\shortquote}[1]{``\emph{#1}''}
\newcommand{\hreftt}[2][https://]{\href{#1#2}{\texttt{#2}}}
%---------------------------------------------------------------------------------------------------
% bib
\RequirePackage{biblatex}
\addbibresource{/home/jesse/refs/library.bib} % TODO: (*) export
\renewcommand*{\multicitedelim}{\addcomma}
\DeclareSourcemap{\maps[datatype=bibtex]{%
  \map{\step[fieldset=abstract,null]}}}
\DeclareSourcemap{\maps[datatype=bibtex]{%
  \map{\step[typesource=techreport,typetarget=report]}}}
\DeclareFieldFormat{url}{\url{#1}}
\renewbibmacro{in:}{}
