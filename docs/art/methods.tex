\section{Methods}\label{art.meth}
Here we describe the model parameterization and calibration,
followed by analyses for Objectives \ref{obj:art.1}~and~\ref{obj:art.2}.
\paragraph{Data Sources}
To inform our model, we used:
published aggregate data from four national surveys
in 2006--2021 \cite{SDHS2006,SHIMS1,SHIMS2,SHIMS3};
aggregate data from a 2021 FSW bio-behavioural survey \cite{EswIBBS2022}; and
individual-level data from two FSW bio-behavioural surveys
in 2011 \cite{Baral2014} and 2014 \cite{EswKP2014},
which were accessed under approval from
\blind{the Scientific and Ethics Committee of the Eswatini Ministry of Health (MH/599B)}, and
\blind{the Institutional Review Board of the Johns Hopkins Bloomberg School of Public Health (3508)}.
%===================================================================================================
\subsection{Model Parameterization \& Calibration}\label{art.meth.par}
The modelled population is stratified by
HIV status, sex, sexual activity, and the ART cascade of care.
Complete details of the model structure, parameterization, and calibration
are given in Appendix~\ref{mod}.
\mf{\input{\app/fig.model}} % model figure
%---------------------------------------------------------------------------------------------------
\paragraph{HIV}
Modelled HIV natural history
includes acute infection and four stages defined by CD4-count:
\cdf{500}{}, \cdf{350}{500}, \cdf{200}{350}, and \cdf{}{200}
(Figure~\ref{fig:model.hiv.m}).
We modelled relative rates of infectiousness by stage
as an approximation of viral load \cite{Boily2009,Donnell2010,Bellan2015ahi},
as well as rates of HIV-attributable mortality by stage \cite{Mangal2017}.
%---------------------------------------------------------------------------------------------------
\paragraph{Risk Heterogeneity}
The model includes eight subpopulations:
FSW and their clients at higher \vs lower risk,
plus other women and men with low and medium sexual activity
(0--1 and 2+ sexual partners in the past year, respectively);
and four sexual partnership types:
main/spousal, casual, repeat sex work, and one-off sex work
(Figure~\ref{fig:model.risk.m}).
We captured risk heterogeneity through:
subpopulation sizes, turnover among subpopulations, genital ulcer disease (GUD),
partnership formation rates and durations, preferential mixing, sex frequency, and condom use
(Table~\ref{tab:art.het}).
To parameterize FSW at higher \vs lower risk, we analyzed individual-level data
from Swati FSW in 2011 \cite{Baral2014} and 2014 \cite{EswKP2014}
(Appendix~\ref{mod.par.fsw}).
We parameterized the remaining subpopulations using data from
national surveys in 2006--2021 \cite{SDHS2006,SHIMS1,SHIMS2,SHIMS3}
(Appendix~\ref{mod.par.wp}--\ref{mod.par.pdur}).
We modelled
increasing condom use (Figure~\ref{fig:fit.condom}),
increasing voluntary medical male circumcision (Figure~\ref{fig:fit.circum}), and
decreasing GUD prevalence over time.
We did not model non-heterosexual HIV transmission
nor pre-exposure prophylaxis (PrEP),
which first became available in Eswatini in 2017
and reached 12\% of FSW by 2021 \cite{EswIBBS2022}.
\begin{table}
  \centering
  \caption{Selected model parameters related to risk heterogeneity}
  \input{tab.het}
  \label{tab:art.het}
\end{table}
%---------------------------------------------------------------------------------------------------
\paragraph{ART Cascade}
The modelled ART cascade includes states for:
undiagnosed HIV, diagnosis before ART, ART before viral suppression, viral suppression,
and a generic ART failure / discontinuation state
(Figure~\ref{fig:model.cascade.m}).
HIV stage-specific infectiousness is then modelled as
reduced on ART but before viral suppression,
zero on ART after viral suppression, and
modestly reduced during ART failure / discontinuation.
We modelled rates of HIV diagnosis among people living with HIV
as monotonically increasing over time.
We defined a base rate for women with low/medium sexual activity,
and fixed relative rates for
men with low/medium sexual activity ($RR < 1$), clients ($RR < 1$), and FSW ($RR > 1$),
reflecting increased HIV testing access via antenatal care among women \vs men,
and enhanced screening among FSW \cite{Baral2014}.
We modelled ART initiation, starting in 2003, similarly except:
the relative rate for ART initiation among FSW was $RR < 1$,
reflecting barriers to uptake and engagement in care \cite{Lancaster2016sr};
we defined additional relative rates by CD4 count ($0 \le RR \le 1$)
to reflect historical ART eligibility criteria (Figure~\ref{fig:art.elig}) \cite{SHIMS2}.
We modelled viral suppression using a fixed rate for all subpopulations,
corresponding to an average of 4 months from ART initiation \cite{Mujugira2016}.
We modelled treatment failure / discontinuation with a single monotonically decreasing rate
applied to all subpopulations in the base case,
reflecting improving treatment success / retention over time \cite{SHIMS2}.
Individuals with treatment failure / discontinuation could re-initiate ART at a fixed rate,
reflecting re-engagement in care or
detection of treatment failure and initiation of alternative regimens.
We modelled rapid CD4 recovery during the first 4 months of ART,
followed by slower recovery while virally suppressed \cite{Gabillard2013}.
We modelled reduced HIV-attributable mortality among individuals on ART,
in addition to mortality benefits of CD4 recovery.
%---------------------------------------------------------------------------------------------------
\paragraph{Calibration}
We calibrated the model to reflect
available data from Eswatini on HIV prevalence, HIV incidence, and ART cascade of care,
overall and stratified by subpopulation where possible
(Tables \ref{tab:targ.prev}--\ref{tab:targ.cascade})
\cite{SDHS2006,SHIMS1,SHIMS2,SHIMS3,Baral2014,EswKP2014,EswIBBS2022}.
We used an adapted version of Incremental Mixture Importance Sampling (IMIS) \cite{Raftery2010},
yielding 1000 total model fits.
Full methodology is given in Appendix~\ref{mod.cal},
while calibration results are given in Appendix~\ref{sr.cal}.
%===================================================================================================
\subsection{Scenarios \& Analysis}\label{art.meth.obj}
%---------------------------------------------------------------------------------------------------
\subsubsection{Objective~1: Influence of ART cascade differences between subpopulations}\label{art.meth.obj.1}
For Objective~\ref{obj:art.1},
We defined the \emph{base case} scenario to reflect
observed ART cascade scale-up in Eswatini, reaching
\cashi for the population overall by 2020 \cite{SHIMS3}, and
88-98-(91) among FSW specifically \cite{EswIBBS2022}.%
\footnote{Data on viral suppression for FSW were not available,
  so we report the median proportion from model fitting in parentheses;
  no cascade data were available for clients specifically.}
Next, we defined four \emph{counterfactual} scenarios in which
the overall population cascade reached \casmd by 2020,
and where FSW, clients, both, or neither were disproportionately left behind.
We chose \casmd to reflect potential attainment if
investment in cascade scale-up had been slower,
as in some other contexts \cite{UNAIDS2023}.
In these counterfactual scenarios, we altered cascade attainment among
FSW, clients, and/or the remaining population (``all others'') by calibrating
fixed subpopulation-specific relative rates of:
diagnosis ($0 \le {RR}_d \le 1$),
treatment initiation ($0 \le {RR}_t \le 1$), and
treatment failure / discontinuation ($1 \le {RR}_u \le 20$).
When FSW and/or clients were left behind, we calibrated their $RR$s such that
these subpopulations attained approximately \caslo by 2020, reflecting
some of the lowest cascades recently observed among key populations \cite{Hakim2018}.
When FSW and/or clients were not left behind, we fixed their $RR=1$,
reflecting maintenance of prioritized outreach/services from the base case.
In all counterfactual scenarios, we calibrated $RR$s for the remaining population such that
the Swati population \emph{overall} attained \casmd in all 4 counterfactual scenarios,
thus ensuring that a consistent proportion of the population overall
attained viral suppression.
Table~\ref{tab:art.1.scen} summarizes these scenarios, while
Figure~\ref{fig:art.1.cascade} plots the modelled cascades over time.
\begin{table}
  \centering
  \caption{Modelling scenarios for Objective~\ref{obj:art.1} defined by 2020 calibration targets}
  \label{tab:art.1.scen}
  \input{tab.scenarios}
\end{table}
\par
We quantified ART prevention impacts via two outcomes: relative
cumulative additional infections and additional incidence rate by 2020
in the counterfactual scenarios ($k$) \vs the base case ($0$):
\begin{equation}\label{eq:art.out}
  \txn{CAI, AIR}\,(t) = \frac{\Omega_{k}(t) - \Omega_{0}(t)}{\Omega_{0}(t)}
  ,\qquad \Omega(t) =
  \begin{cases}
    ~\int_{t_0}^{t}\!\Lambda(\tau)\,d\tau & \txn{CAI: cumulative additional infections} \\
    ~\lambda(t) & \txn{AIR: additional incidence rate}
  \end{cases}
\end{equation} where:
$\Lambda$ denotes absolute numbers of infections per year,
$\lambda$ denotes incidence rate per susceptible per year,
and $t_0 = 2000$.
For each scenario, we computed these outcomes for each model fit $f$,
and reported median (95\% credible interval, CI) values across model fits, reflecting uncertainty.
%---------------------------------------------------------------------------------------------------
\subsubsection{Objective~2: Conditions that maximize the influence of ART cascade differences}\label{art.meth.obj.2}
For Objective~\ref{obj:art.2}, we estimated via linear regression:
the effects of lower ART cascade among FSW and clients on each outcome
plus potential effect modification by epidemic conditions.
The hypothesized causal effects are illustrated
as a directed acyclic graph in Figure~\ref{fig:art.2.dag}.
As explained in \sref{sr.art.2}, this approach aims to improve upon
conventional sensitivity analyses for HIV transmission models \cite{Blower1994}.
\par
For this regression, we generated 10,000 synthetic samples as follows.
We explored a wider range of counterfactual scenarios \vs Objective~\ref{obj:art.1}
by randomly sampling the relative rates for
diagnosis and treatment initiation ${RR}_d, {RR}_t \sim \opname{Beta}$ with 95\%~CI (0.25,~0.95),
and treatment failure / discontinuation ${RR}_u \sim \opname{Gamma}$ with 95\%~CI (1.5,~15),
for each of: FSW, clients, and the remaining population (9~total values),
yielding cascades in 2020 spanning
approximately \mbox{60-60-90} through \mbox{85-90-95} (Figure~\ref{fig:art.2.cascade}). % MAN
For each of $N_f = 1000$ model fits,
we generated $N_k = 10$ counterfactual scenarios per fit
using Latin hypercube sampling of $RR$s \cite{Stein1987},
yielding $N_f N_k = {}$10,000 total counterfactual scenario samples for the regression.
\par
For each of these 10,000 samples, we defined each outcome as in \eqref{eq:art.out}.
For each sample, we further defined
$U_{fki}$ for subpopulations $i \in \{\tdef{1}{FSW}, \tdef{2}{clients}, \tdef{*}{overall}\}$
as the proportions \emph{not} virally suppressed among those living with HIV by 2020,
reflecting a summary measure of ART cascade gaps.
Using $U_{fki}$, we defined the main regression predictors as:
$D_{fk} = U_{fk*} - U_{f0*} > 0$, reflecting differences in
\emph{population overall} viral non-suppression in sample $k \in [1,10]$
\vs the base case (denoted $k = 0$); and
$d_{fki} = U_{fki} - U_{fk*} \lessgtr 0$, reflecting differences in
\emph{subpopulation-$i$-specific} viral non-suppression in sample $k$
\vs the population overall in sample $k$ --- \ie viral non-suppression inequalities.
\par
Next, we defined the following measures of epidemic conditions ($C_{fj}$),
as hypothesized modifiers of the effect of unequal viral non-suppression on relative CAI and RAI:
FSW and client population sizes (\% of population overall);
average rate of turnover among FSW and clients (reciprocal of duration selling / buying sex); and
HIV incidence ratios in 2010 among FSW \vs women overall, and among clients \vs men overall.
We used HIV incidence ratios to reflect summary measures of risk heterogeneity,
rather than including all risk factors from the transmission model,
which could lead to overfitting and improper inference due to effect mediation.
\par
Finally, we defined a general linear model for each outcome as:
\begin{equation}\label{eq:art.2.glm}
  \txn{CAI, AIR} = \beta_0
                 + \beta_1\,D
                 + \sum_i \beta_i\,d_i
                 + \sum_{ij} \beta_{ij}\,d_i\,C_j
\end{equation}
such that each outcome was modelled as a liner sum of an intercept plus effects of:
differential population-level non-suppression in the counterfactual \vs the base scenario ($D$);
differential non-suppression among FSW and clients
\vs the population overall within the counterfactual scenario ($d_i$); and
effect modification of $d_i$ by epidemic conditions ($C_j$).
We fitted this model for each outcome using generalized estimating equations \cite{Hojsgaard2006}
to control for repeated use of each model fit $f$.
We standardized all model variables ($D$, $d_i$, $C_j$) via
$\hat{x} = (x - \txn{mean}(x)) / \txn{SD}(x)$
to avoid issues of different variable scales and collinearity in interaction terms.
Effect sizes can thus be interpreted as
the expected change in outcome per standard deviation change in the variable.%
\footnote{However, regression coefficient magnitudes
  should not be compared to indicate variable ``importance'',
  because the standardization applied to each variable
  is driven by the variance before standardization \cite{Rajerison2012}.}
We verified the appropriateness of a linear link function by examining residuals
(Figures~\ref{fig:art.2.r}).
